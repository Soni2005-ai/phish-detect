<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Phishing Detection â€” Real</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { padding: 30px; max-width: 900px; margin:auto; }
    pre { background:#f7f7f9; padding:10px; border-radius:6px; }
  </style>
</head>
<body>
  <h2>AI/ML Real-Time Phishing Detector</h2>
  <p>Paste URL below, click <b>Scan</b>. This does a live website scan (HTTP, WHOIS, TLS).</p>

  <div class="mb-3">
    <input id="url" class="form-control" placeholder="https://example.com/login" />
  </div>
  <button class="btn btn-primary" onclick="scan()">Scan</button>

  <hr/>
  <div id="result"></div>

<script>
async function scan(){
  const url = document.getElementById('url').value;
  const result = document.getElementById('result');
  result.innerHTML = "<div class='alert alert-info'>Scanning...</div>";
  try {
    const res = await fetch('/scan', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({url})
    });
    const j = await res.json();
    if(j.error) { result.innerHTML = "<div class='alert alert-danger'>"+j.error+"</div>"; return; }

    let html = `<h4>Verdict: <span class="${j.verdict==='phishing'?'text-danger':'text-success'}">${j.verdict.toUpperCase()}</span></h4>`;
    html += `<p>Confidence: ${j.confidence ? Math.round(j.confidence*100) + '%' : 'N/A'}</p>`;
    if(j.flags && j.flags.length) {
      html += `<div class="alert alert-warning"><b>Flags:</b><br>${j.flags.join(', ')}</div>`;
    }
    html += `<h5>HTML features</h5><pre>${JSON.stringify(j.html_features, null, 2)}</pre>`;
    html += `<h5>WHOIS</h5><pre>${JSON.stringify(j.whois, null, 2)}</pre>`;
    html += `<h5>TLS</h5><pre>${JSON.stringify(j.tls, null, 2)}</pre>`;
    result.innerHTML = html;
  } catch(e){
    result.innerHTML = "<div class='alert alert-danger'>Error: " + e + "</div>";
  }
}
</script>
</body>
</html>
